<!doctype html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Boutique - BURNIE-SHOP</title>
    <link rel="shortcut icon" href="./fille.jpeg" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: { primary: "#000000", gold: "#d4af37" },
          },
        },
      };
    </script>
    <style>
      .line-clamp-2 {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
      }
      .product-card {
        transition: all 0.3s ease;
      }
      .product-card:hover {
        transform: translateY(-8px);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
      }
      .filter-btn.active {
        background-color: #000;
        color: #fff;
      }
    </style>
  </head>
  <body class="bg-gray-100 text-gray-900">
    <!-- NAVBAR (copied from site design) -->
    <nav
      class="flex justify-between items-center px-4 md:px-8 py-4 bg-white shadow-md sticky top-0 z-50"
    >
      <div class="flex items-center gap-4">
        <!-- MOBILE MENU BUTTON -->
        <button
          onclick="toggleSidebar()"
          class="md:hidden px-4 py-2 rounded-full font-semibold transition border-2 border-gold text-gold hover:bg-gold hover:text-black"
        >
          <svg
            class="w-6 h-6 stroke-gold"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 6h16M4 12h16M4 18h16"
            ></path>
          </svg>
        </button>
        <a href="index.html" class="text-xl md:text-2xl font-bold tracking-wide"
          >BURNIE<span class="text-gold">SHOP</span></a
        >
      </div>
      <div class="hidden md:flex gap-6 items-center">
        <a
          href="index.html"
          class="font-semibold hover:text-gold transition"
          data-lang="nav-home"
          >Home</a
        >
        <a
          href="boutique.html"
          class="font-semibold text-gold"
          data-lang="nav-boutik"
          >Boutique</a
        >
        <a
          href="gallery.html"
          class="font-semibold hover:text-gold transition"
          data-lang="nav-gallery"
          >Gallery</a
        >
        <a
          href="contact.html"
          class="font-semibold hover:text-gold transition"
          data-lang="nav-contact"
          >Contact</a
        >
        <!-- language switches -->
        <div class="flex items-center gap-2">
          <button
            onclick="switchLanguage('fr')"
            class="px-3 py-1 text-sm font-semibold border-2 border-gold text-gold hover:bg-gold hover:text-black transition"
            id="lang-fr"
          >
            FR
          </button>
          <button
            onclick="switchLanguage('en')"
            class="px-3 py-1 text-sm font-semibold border-2 border-gray-300 text-gray-600 hover:bg-gray-300 hover:text-black transition"
            id="lang-en"
          >
            EN
          </button>
        </div>
      </div>
    </nav>

    <!-- MOBILE SIDEBAR -->
    <div
      id="sidebarOverlay"
      class="fixed inset-0 bg-black/50 z-40 hidden md:hidden"
      onclick="closeSidebar()"
    ></div>
    <div
      id="sidebar"
      class="fixed left-0 top-0 h-full w-[85vw] max-w-80 bg-white shadow-lg z-50 transform -translate-x-full transition-transform duration-300 md:hidden"
    >
      <div class="p-6">
        <button
          onclick="closeSidebar()"
          class="absolute top-4 right-4 text-2xl font-bold"
        >
          ×
        </button>
        <h2 class="text-xl font-bold mb-6 text-center">Menu</h2>
        <div class="space-y-4">
          <a
            href="index.html"
            class="block py-2 px-4 rounded hover:bg-gray-100 transition"
            onclick="closeSidebar()"
            data-lang="nav-home"
            >Home</a
          >
          <a
            href="boutique.html"
            class="block py-2 px-4 rounded hover:bg-gray-100 transition"
            onclick="closeSidebar()"
            data-lang="nav-boutik"
            >Boutique</a
          >
          <a
            href="gallery.html"
            class="block py-2 px-4 rounded hover:bg-gray-100 transition"
            onclick="closeSidebar()"
            data-lang="nav-gallery"
            >Gallery</a
          >
          <a
            href="contact.html"
            class="block py-2 px-4 rounded hover:bg-gray-100 transition"
            onclick="closeSidebar()"
            data-lang="nav-contact"
            >Contact</a
          >
        </div>
        <div class="mt-8 pt-6 border-t border-gray-200">
          <h3 class="text-lg font-semibold mb-4 text-center">Langue</h3>
          <div class="flex justify-center gap-2 mb-6">
            <button
              onclick="
                switchLanguage('fr');
                closeSidebar();
              "
              class="px-4 py-2 text-sm font-semibold border-2 border-gold text-gold hover:bg-gold hover:text-black transition"
              id="lang-fr-mobile"
            >
              FR
            </button>
            <button
              onclick="
                switchLanguage('en');
                closeSidebar();
              "
              class="px-4 py-2 text-sm font-semibold border-2 border-gray-300 text-gray-600 hover:bg-gray-300 hover:text-black transition"
              id="lang-en-mobile"
            >
              EN
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- HERO -->
    <section class="px-4 md:px-16 py-12 md:py-20 bg-white text-center">
      <h1 class="text-4xl md:text-5xl font-bold mb-4" data-lang="page-title">
        Boutique
      </h1>
    </section>

    <!-- CATEGORY FILTER -->
    <section class="sticky top-16 z-40 bg-white shadow-sm px-4 md:px-8 py-4">
      <div class="max-w-7xl mx-auto">
        <div class="flex flex-wrap items-center justify-between gap-4">
          <div class="flex flex-wrap gap-2">
            <button
              onclick="setFilter('all')"
              class="filter-btn active px-4 py-2 rounded-full text-sm font-semibold border-2 border-black transition hover:bg-black hover:text-white"
            >
              All
            </button>
            <button
              onclick="setFilter('sandales')"
              class="filter-btn px-4 py-2 rounded-full text-sm font-semibold border-2 border-gray-300 transition hover:border-black"
            >
              Sandales
            </button>
            <button
              onclick="setFilter('valises')"
              class="filter-btn px-4 py-2 rounded-full text-sm font-semibold border-2 border-gray-300 transition hover:border-black"
            >
              Valises
            </button>
            <button
              onclick="setFilter('vetements')"
              class="filter-btn px-4 py-2 rounded-full text-sm font-semibold border-2 border-gray-300 transition hover:border-black"
            >
              Vêtements
            </button>
            <button
              onclick="setFilter('others')"
              class="filter-btn px-4 py-2 rounded-full text-sm font-semibold border-2 border-gray-300 transition hover:border-black"
            >
              Other
            </button>
          </div>
          <div class="flex items-center gap-4">
            <input
              id="searchInput"
              onkeyup="filterProducts()"
              placeholder="Rechercher..."
              class="border rounded-full px-3 py-2 text-sm w-48 mr-3"
            />
            <span
              id="productCount"
              class="text-sm text-gray-500"
              data-lang="product-count"
              >Produits</span
            >
          </div>
        </div>
      </div>
    </section>

    <!-- PRODUCTS GRID -->
    <section class="px-4 md:px-8 py-8 md:py-12">
      <div class="max-w-7xl mx-auto">
        <div
          id="productsGrid"
          class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 md:gap-6"
        ></div>

        <div
          id="emptyMessage"
          class="mt-8 text-center text-gray-500 hidden"
          data-lang="empty-msg"
        >
          
        </div>

        <!-- PRODUCT MODAL -->
        <div
          id="productModal"
          class="fixed inset-0 z-50 hidden items-center justify-center"
        >
          <div
            class="absolute inset-0 bg-black/60"
            onclick="closeModal()"
          ></div>
          <div
            class="relative bg-white rounded-xl max-w-3xl w-full mx-4 overflow-hidden shadow-2xl"
          >
            <button
              onclick="closeModal()"
              class="absolute top-3 right-3 bg-white p-2 rounded-full hover:bg-gray-100"
            >
              ✕
            </button>
            <div class="p-4 md:p-6 flex flex-col md:flex-row gap-4">
              <div class="w-full md:w-1/3">
                <img
                  id="modalImage"
                  src=""
                  alt=""
                  class="w-full h-64 object-cover rounded-lg"
                />
              </div>
              <div class="flex-1">
                <h3 id="modalTitle" class="text-xl font-bold mb-2"></h3>
                <p id="modalDesc" class="text-gray-600 text-sm mb-4"></p>
                <div class="flex gap-3">
                  <a
                    id="modalContactBtn"
                    href="contact.html"
                    class="inline-block bg-black text-white px-4 py-2 rounded-lg font-semibold hover:bg-gold"
                    data-lang="contact-btn"
                    >Contactez-nous</a
                  >
                  <button
                    onclick="closeModal()"
                    class="inline-block bg-gray-100 text-black px-4 py-2 rounded-lg"
                    data-lang="close-btn"
                  >
                    Fermer
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <script>
      // Sidebar toggle functions
      function toggleSidebar() {
        const sidebar = document.getElementById("sidebar");
        const overlay = document.getElementById("sidebarOverlay");
        sidebar.classList.toggle("-translate-x-full");
        overlay.classList.toggle("hidden");
      }

      function closeSidebar() {
        const sidebar = document.getElementById("sidebar");
        const overlay = document.getElementById("sidebarOverlay");
        sidebar.classList.add("-translate-x-full");
        overlay.classList.add("hidden");
      }

      // filenames from the Sandals/ folder
      const sandalFiles = [
        "0001_BALENCIAGA SANDAL.jpeg",
        "0002_SAINT LAURENT SANDAL.jpeg",
        "0003_SAINT LAURENT COLOR COLLECTION SANDAL.jpeg",
        "0004_BALENCIAGA SANDAL.jpeg",
        "0005_SAINT LAURENT SANDAL.jpeg",
        "0006_BALENCIAGA COLOR COLLECTION SANDAL.jpeg",
        "0007_LOUIS VUITTON COLOR COLLECTION SANDAL.jpeg",
        "0008_CHRITIAN DIOR SANDAL.jpeg",
        "0009_LOUIS VUITTON SANDAL.jpeg",
        "0010_CHRITIAN DIOR SANDAL.jpeg",
        "0011_CHRITIAN DIOR COLOR COLLECTION SANDAL.jpeg",
        "0012_CELINE SANDAL.jpeg",
        "0013_CELINE SANDAL.jpeg",
        "0014_CHRITIAN DIOR SANDAL.jpeg",
        "0015_DOLCE GABANA SANDAL.jpeg",
        "0016_DOLCE GABANA SANDAL.jpeg",
        "0017_DOLCE GABANA SANDAL.jpeg",
        "0018_DOLCE GABANA COLOR COLLECTION SANDAL.jpeg",
        "0019_DOLCE GABANA SANDAL.jpeg",
        "0020_DOLCE GABANA SANDAL.jpeg",
        "0021_DOLCE GABANA COLOR COLLECTION SANDAL.jpeg",
        "0022_LOUIS VUITTON SANADL.jpeg",
        "0023_LOUIS VUITTON SANDAL.jpeg",
        "0024_FENDI SANDAL.jpeg",
        "0025_FENDI SANDAL.jpeg",
        "0026_FENDI SANDAL.jpeg",
        "0027_LOUIS VUITTON COLOR COLLECTION SANDAL.jpeg",
        "0028_GUCCI COLOR COLLECTION SANDAL.jpeg",
        "0029_FENDI COLOR COLLECTION SANDAL.jpeg",
        "0030_COACH SANDAL.jpeg",
        "0031_GUCCI COLOR COLLECTION SANDAL.jpeg",
        "0032_CAROLINA HERRERA SANDAL.jpeg",
        "0033_CHANEL COLOR COLLECTION SANDAL.jpeg",
        "0034_LOUIS VUITTON COLOR COLLECTION SANDAL.jpeg",
        "0035_MIU MIU COLOR COLLECTION SANDAL.jpeg",
        "0036_BALENCIAGA COLOR COLLECTION SANDAL.jpeg",
        "0037_CHANEL SANDAL.jpeg",
        "0038CHANEL SANDAL.jpeg",
        "0039_GUCCI SANDAL.jpeg",
        "0040_GUCCI SANDAL.jpeg",
        "0041_GUCCI COLOR COLLECTION SANDAL.jpeg",
        "0042_GUCCI SANDAL.jpeg",
        "0043_GUCCI SANDAL.jpeg",
        "0044_BALENCIAGA COLOR COLLECTION SANDAL.jpeg",
      ];

      // filenames from the Bags/ folder (valises category)
      const bagFiles = [
        "0001_COACH GREEN BAG.jpeg",
        "0002_COACH BAG .jpeg",
        "0003_COACH COLOR  COLLECTION BAG.jpeg",
        "0004_DIOR CHRITIAN WHITE BAG.jpeg",
        "0005_DIOR CHRITIAN BROWN BAG.jpeg",
        "0006_DIOR CHRITIAN BLACK BAG.jpeg",
        "0007_DIOR CHRITIAN COLOR COLLECTION BAG.jpeg",
        "0008_LOUIS VUITTON BROWN BAG.jpeg",
        "0009_LOUIS VUITTON COLOR COLLECTION BAG.jpeg",
        "0010_GUCCI BAG.jpeg",
        "0011_GUCCI BAG.jpeg",
        "0012_GUCCI BAG.jpeg",
        "0013_COACH BAG.jpeg",
        "0014_LOUIS VUITTON PURPLE BAG.jpeg",
        "0015_LOUIS VUITTON PINK  BAG.jpeg",
        "0016_OUIS VUITTON BLACK BAG.jpeg",
        "0017_FASHION BLACK BAG.jpeg",
        "0018_FASHION WHITE BAG.jpeg",
        "0019_FASHION BAG.jpeg",
        "0020_PRADA BLACK BAG.jpeg",
        "0021_BALMAIN BAG.jpeg",
        "0022_BALENCIAGA BAG.jpeg",
        "0023_BALENCIAGA BAG.jpeg",
        "0024_CAMILLE SELIN BAG.jpeg",
        "0025_BALENCIAGA BAG.jpeg",
        "0026_CAMILLE SELIN BAG.jpeg",
        "0027_CAMMILE SELIN BAG.jpeg",
        "0028_LOUIS VUITTON BAG.jpeg",
        "0029_LOUIS VUITTON BAG.jpeg",
        "0030_LOUIS VUITTON BAG.jpeg",
        "0031_FASHION BAG.jpeg",
        "0032_FASHION BAG.jpeg",
        "0033_FASHION BAG.jpeg",
        "0034_FASHION BAG.jpeg",
        "0035_NR FASHION BAG.jpeg",
        "0036_NR FASHION BAG.jpeg",
        "0037_FASHION & BAG.jpeg",
        "0038_FASHION BAG.jpeg",
        "0039_PEDRA FASHION BAG.jpeg",
        "0040_FERRAGAMO BAG.jpeg",
        "0041_PEDRA FASHION BAG.jpeg",
        "0042_LOUIS VUITTON BAG.jpeg",
        "0043_GUCCI BAG.jpeg",
        "0044_GUCCI BAG.jpeg",
        "0045_LOUIS VUITTON BAG.jpeg",
        "0046_LOUIS VUITTON BAG.jpeg",
        "0047_LOUIS VUITTON.jpeg",
        "0048_LOUIS VUITTON.jpeg",
        "0049_GUCCI BAG.jpeg",
        "0050_GUCCI BAG.jpeg",
        "0051_GUCCI BAG.jpeg",
        "0052_GUCCI BAG.jpeg",
        "0053_LOUIS VUITTON BAG.jpeg",
        "0054_LOUIS VUITTON BAG.jpeg",
        "0055_LOUIS VUITTON.jpeg",
      ];

      // generic card creator: provide filename, folder name, and category id
      function createCard(filename, folder, category, label) {
        const displayName = filename
          .replace(/^\d+_?/, "")
          .replace(/\.jpe?g$/i, "")
          .replace(/_/g, " ")
          .trim();
        const card = document.createElement("div");
        card.className = "product-card group";
        card.dataset.category = category;
        card.dataset.title = displayName.toLowerCase();

        card.innerHTML = `
      <div class="relative overflow-hidden rounded-t-2xl">
        <img src="${folder}/${filename}" alt="${displayName}" class="w-full h-48 sm:h-56 md:h-64 object-cover group-hover:scale-110 transition-transform duration-500" loading="lazy" onerror="this.src='https://via.placeholder.com/400x400?text=Image'">
      </div>
      <div class="bg-white p-4 rounded-b-2xl">
        <h3 class="font-bold text-sm sm:text-base line-clamp-2 h-12 mb-2">${displayName}</h3>
        <div class="flex items-center justify-between"><span class="text-xs text-gray-500 uppercase tracking-wide">${label}</span></div>
      </div>
    `;
        return card;
      }

      function populateGrid() {
        const grid = document.getElementById("productsGrid");
        grid.innerHTML = "";
        // add sandals
        sandalFiles.forEach((f) => {
          const card = createCard(f, "Sandals", "sandales", "sandales");
          const img = card.querySelector("img");
          const displayName = f
            .replace(/^\d+_?/, "")
            .replace(/\.jpe?g$/i, "")
            .replace(/_/g, " ")
            .trim();
          img.style.cursor = "pointer";
          img.addEventListener("click", () =>
            openModal(f, displayName, "Sandals"),
          );
          grid.appendChild(card);
        });
        // add bags as valises
        bagFiles.forEach((f) => {
          const card = createCard(f, "Bags", "valises", "valises");
          const img = card.querySelector("img");
          const displayName = f
            .replace(/^\d+_?/, "")
            .replace(/\.jpe?g$/i, "")
            .replace(/_/g, " ")
            .trim();
          img.style.cursor = "pointer";
          img.addEventListener("click", () =>
            openModal(f, displayName, "Bags"),
          );
          grid.appendChild(card);
        });
      }

      let currentFilter = "all";
      let currentSearch = "";

      function setFilter(filter) {
        currentFilter = filter;
        // update active button styles
        document.querySelectorAll(".filter-btn").forEach((btn) => {
          btn.classList.remove(
            "active",
            "bg-black",
            "text-white",
            "border-black",
          );
          btn.classList.add("border-gray-300");
        });
        // try to find matching button and mark active
        document.querySelectorAll(".filter-btn").forEach((b) => {
          const txt = b.textContent.trim().toLowerCase();
          if ((filter === "all" && txt === "all") || txt.includes(filter)) {
            b.classList.add("active", "bg-black", "text-white", "border-black");
            b.classList.remove("border-gray-300");
          }
        });
        applyFilters();
      }

      function filterProducts() {
        const val = (document.getElementById("searchInput")?.value || "")
          .toLowerCase()
          .trim();
        currentSearch = val;
        // keep input normalized
        if (document.getElementById("searchInput"))
          document.getElementById("searchInput").value = val;
        applyFilters();
      }

      function applyFilters() {
        const cards = document.querySelectorAll(".product-card");
        let visibleCount = 0;
        cards.forEach((card) => {
          const category = card.dataset.category;
          const title = card.dataset.title || "";
          const matchesCategory =
            currentFilter === "all" || category === currentFilter;
          const matchesSearch =
            currentSearch === "" || title.includes(currentSearch);
          if (matchesCategory && matchesSearch) {
            card.style.display = "block";
            card.style.opacity = "1";
            visibleCount++;
          } else {
            card.style.opacity = "0";
            setTimeout(() => (card.style.display = "none"), 200);
          }
        });
        document.getElementById("productCount").textContent =
          visibleCount + " produits";
        document
          .getElementById("emptyMessage")
          .classList.toggle("hidden", visibleCount > 0);
      }

      // Translations (minimal for this page)
      const translations = {
        fr: {
          "nav-home": "Accueil",
          "nav-boutik": "Boutique",
          "nav-gallery": "Galerie",
          "nav-contact": "Contact",
          "page-title": "Boutique",
          "page-sub": "Chwazi kategori w: Sandales, Valises, Vêtements, Other",
          "product-count": "Produits",
          "empty-msg": "Pa gen pwodwi pou kategori sa a.",
          "contact-btn": "Contactez-nous",
          "close-btn": "Fermer",
          "wa-modal-title": "Demande — WhatsApp",
          "wa-product-label": "Produit :",
          "wa-fullname-label": "Nom complet",
          "wa-fullname-placeholder": "(optionnel)",
          "wa-message-label": "Message",
          "wa-message-placeholder": "(optionnel)",
          "wa-location-label": "Localisation",
          "wa-location-placeholder": "(optionnel)",
          "wa-detect": "Détecter localisation",
          "wa-detecting": "Détection...",
          "wa-cancel": "Annuler",
          "wa-send": "Envoyer sur WhatsApp",
        },
        en: {
          "nav-home": "Home",
          "nav-boutik": "Shop",
          "nav-gallery": "Gallery",
          "nav-contact": "Contact",
          "page-title": "Shop",
          "page-sub": "Choose a category: Sandals, Luggage, Clothing, Other",
          "product-count": "Products",
          "empty-msg": "No products for this category.",
          "contact-btn": "Contact us",
          "close-btn": "Close",
          "wa-modal-title": "Request — WhatsApp",
          "wa-product-label": "Product:",
          "wa-fullname-label": "Full name",
          "wa-fullname-placeholder": "(optional)",
          "wa-message-label": "Message",
          "wa-message-placeholder": "(optional)",
          "wa-location-label": "Location",
          "wa-location-placeholder": "(optional)",
          "wa-detect": "Detect location",
          "wa-detecting": "Detecting...",
          "wa-cancel": "Cancel",
          "wa-send": "Send on WhatsApp",
        },
      };

      function switchLanguage(lang) {
        // Update button styles if buttons exist
        const frBtn = document.getElementById("lang-fr");
        const enBtn = document.getElementById("lang-en");
        const frBtnMobile = document.getElementById("lang-fr-mobile");
        const enBtnMobile = document.getElementById("lang-en-mobile");
        
        if (frBtn && enBtn) {
          if (lang === "fr") {
            frBtn.classList.add("border-gold", "text-gold");
            frBtn.classList.remove("border-gray-300", "text-gray-600");
            enBtn.classList.add("border-gray-300", "text-gray-600");
            enBtn.classList.remove("border-gold", "text-gold");
          } else {
            enBtn.classList.add("border-gold", "text-gold");
            enBtn.classList.remove("border-gray-300", "text-gray-600");
            frBtn.classList.add("border-gray-300", "text-gray-600");
            frBtn.classList.remove("border-gold", "text-gold");
          }
        }
        
        if (frBtnMobile && enBtnMobile) {
          if (lang === "fr") {
            frBtnMobile.classList.add("border-gold", "text-gold");
            frBtnMobile.classList.remove("border-gray-300", "text-gray-600");
            enBtnMobile.classList.add("border-gray-300", "text-gray-600");
            enBtnMobile.classList.remove("border-gold", "text-gold");
          } else {
            enBtnMobile.classList.add("border-gold", "text-gold");
            enBtnMobile.classList.remove("border-gray-300", "text-gray-600");
            frBtnMobile.classList.add("border-gray-300", "text-gray-600");
            frBtnMobile.classList.remove("border-gold", "text-gold");
          }
        }

        const elements = document.querySelectorAll("[data-lang]");
        elements.forEach((element) => {
          const key = element.getAttribute("data-lang");
          if (translations[lang] && translations[lang][key]) {
            const tag = (element.tagName || '').toUpperCase();
            if (tag === 'INPUT' || tag === 'TEXTAREA') {
              element.placeholder = translations[lang][key];
            } else {
              element.textContent = translations[lang][key];
            }
          }
        });

        document.documentElement.lang = lang;
        localStorage.setItem("preferredLanguage", lang);
      }

      // Initialize page
      document.addEventListener("DOMContentLoaded", () => {
        const savedLang = localStorage.getItem("preferredLanguage") || "fr";
        switchLanguage(savedLang);
        populateGrid();
        // start with all filters
        setFilter("all");
      });

      // Modal control
      // holds current product shown in modal so share button can access it
      let currentModalProduct = null;

      function openModal(filename, displayName, folder) {
        currentModalProduct = { filename, displayName, folder };
        const modal = document.getElementById("productModal");
        const img = document.getElementById("modalImage");
        const title = document.getElementById("modalTitle");
        const desc = document.getElementById("modalDesc");
        const contactBtn = document.getElementById("modalContactBtn");
        img.src = `${folder}/${filename}`;
        img.alt = displayName;
        title.textContent = displayName;
        desc.textContent = `Produit: ${displayName}`;

        const imageUrl = folder + "/" + filename;
        contactBtn.href = "#";
        contactBtn.onclick = function(e) {
          e.preventDefault();
          sendProductToWhatsApp(displayName, imageUrl);
        };

        modal.classList.remove("hidden");
        modal.classList.add("flex");
      }

      function getPreviewUrl(imageUrl, title) {
        if (!imageUrl) return '';
        try {
          const origin = window.location.origin || (location.protocol + '//' + location.host);
          const q = 'src=' + encodeURIComponent(imageUrl) + (title ? '&title=' + encodeURIComponent(title) : '');
          return origin + '/view_image.html?' + q;
        } catch (e) {
          return 'view_image.html?src=' + encodeURIComponent(imageUrl) + (title ? '&title=' + encodeURIComponent(title) : '');
        }
      }

      function sendProductToWhatsApp(productName, imageUrl) {
        const waModal = document.getElementById('waPromptModal');
        if (!waModal) return;
        waModal.dataset.product = productName;
        waModal.dataset.image = imageUrl;
        document.getElementById('waPromptProduct').textContent = productName;
        document.getElementById('waPromptFullName').value = '';
        document.getElementById('waPromptMessage').value = '';
        document.getElementById('waPromptLocation').value = '';
        waModal.classList.remove('hidden');
        waModal.classList.add('flex');
      }

      function sendProductToWhatsAppFinal(productName, imageUrl, userFullName, userMsg, userLoc) {
        const origin = window.location.origin || 'http://127.0.0.1:5500';
        const imageFull = `${origin}/${imageUrl}`;
        const imageLink = `${origin}/view_image.html?src=${encodeURIComponent(imageFull)}`;
        let whatsappText = `*BURNIE SHOP - Demande de Produit*\n\n`;
        if (userFullName) whatsappText += `*Nom complet / Full name:* ${userFullName}\n\n`;
        whatsappText += `*Produit:* ${productName}\n\n`;
        if (userMsg) whatsappText += `*Message:*\n${userMsg}\n\n`;
        if (userLoc) {
          let mapsUrl = '';
          const coordMatch = userLoc.match(/\s*([-+]?\d+\.?\d*)\s*,\s*([-+]?\d+\.?\d*)\s*/);
          if (coordMatch) {
            mapsUrl = `https://www.google.com/maps/search/?api=1&query=${coordMatch[1]},${coordMatch[2]}`;
          } else if (/^https?:\/\//i.test(userLoc)) {
            mapsUrl = userLoc;
          } else {
            mapsUrl = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(userLoc)}`;
          }
          whatsappText += `*Localisation:*\n${mapsUrl}\n\n`;
        }
        whatsappText += imageLink;
        const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
        if (isMobile) {
          window.open(`https://wa.me/50932242766?text=${encodeURIComponent(whatsappText)}`, '_blank');
        } else {
          window.open(`https://web.whatsapp.com/send?phone=50932242766&text=${encodeURIComponent(whatsappText)}`, '_blank');
        }
      }

      function closeModal() {
        const modal = document.getElementById("productModal");
        modal.classList.remove("flex");
        modal.classList.add("hidden");
      }

      // WhatsApp prompt modal handlers
      document.addEventListener('DOMContentLoaded', function() {
        const waModal = document.getElementById('waPromptModal');
        if (waModal) {
          document.getElementById('waCancel')?.addEventListener('click', function() {
            waModal.classList.add('hidden'); waModal.classList.remove('flex');
          });

          document.getElementById('waDetectLocation')?.addEventListener('click', function() {
            const btn = this;
            btn.disabled = true;
            btn.textContent = translations[document.documentElement.lang]?.['wa-detecting'] || 'Detecting...';
            if (!navigator.geolocation) {
              alert('Geolocation not supported by your browser');
              btn.disabled = false; btn.textContent = translations[document.documentElement.lang]?.['wa-detect'] || 'Detect location';
              return;
            }
            navigator.geolocation.getCurrentPosition(function(pos) {
              const lat = pos.coords.latitude.toFixed(5);
              const lon = pos.coords.longitude.toFixed(5);
              document.getElementById('waPromptLocation').value = `${lat}, ${lon}`;
              btn.disabled = false; btn.textContent = translations[document.documentElement.lang]?.['wa-detect'] || 'Detect location';
            }, function(err) {
              alert('Erreur detection: ' + err.message);
              btn.disabled = false; btn.textContent = translations[document.documentElement.lang]?.['wa-detect'] || 'Detect location';
            }, {timeout:10000});
          });

          document.getElementById('waSend')?.addEventListener('click', function() {
            const product = waModal.dataset.product || '';
            const image = waModal.dataset.image || '';
            const fullName = document.getElementById('waPromptFullName').value || '';
            const msg = document.getElementById('waPromptMessage').value || '';
            const loc = document.getElementById('waPromptLocation').value || '';
            waModal.classList.add('hidden'); waModal.classList.remove('flex');
            sendProductToWhatsAppFinal(product, image, fullName, msg, loc);
          });
        }
      });
 
    </script>

    <!-- WhatsApp prompt modal -->
    <div id="waPromptModal" class="hidden fixed inset-0 z-50 items-center justify-center bg-black/60">
      <div class="bg-white rounded p-4 max-w-md w-full mx-4">
        <h3 class="font-bold text-lg mb-2" data-lang="wa-modal-title">Demande — WhatsApp</h3>
        <p class="text-sm text-gray-600 mb-2"><span data-lang="wa-product-label">Produit :</span> <span id="waPromptProduct" class="font-semibold"></span></p>
        <label class="block text-sm font-medium" data-lang="wa-fullname-label">Nom complet</label>
        <input id="waPromptFullName" data-lang="wa-fullname-placeholder" class="w-full p-2 border rounded mb-2" placeholder="(optionnel)" />
        <label class="block text-sm font-medium" data-lang="wa-message-label">Message</label>
        <textarea id="waPromptMessage" data-lang="wa-message-placeholder" rows="3" class="w-full p-2 border rounded mb-2" placeholder="(optionnel)"></textarea>
        <label class="block text-sm font-medium" data-lang="wa-location-label">Localisation</label>
        <div class="flex gap-2 mb-4">
          <input id="waPromptLocation" data-lang="wa-location-placeholder" class="flex-1 p-2 border rounded" placeholder="(optionnel)" />
          <button id="waDetectLocation" class="px-3 py-2 rounded bg-gray-200 text-sm" data-lang="wa-detect">Détecter localisation</button>
        </div>
        <div class="flex justify-end gap-2">
          <button id="waCancel" class="px-4 py-2 rounded bg-gray-200" data-lang="wa-cancel">Annuler</button>
          <button id="waSend" class="px-4 py-2 rounded bg-green-600 text-white" data-lang="wa-send">Envoyer sur WhatsApp</button>
        </div>
      </div>
    </div>
  </body>
</html>
